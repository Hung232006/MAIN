<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Shoe Store</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>
<body>
<div class="app">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">Admin</div>
    <div class="role">Quản trị viên</div>
    <nav class="nav">
      <a href="#" onclick="showSection('dashboard')" class="active">Dashboard</a>
      <a href="#" onclick="showSection('products')">Products</a>
      <a href="#" onclick="showSection('orders')">Orders</a>
    </nav>
  </aside>

  <!-- MAIN -->
  <main class="main">

    <!-- DASHBOARD -->
    <section id="dashboard" class="main-section">
      <!-- TOP STATS -->
      <section class="stats">
        <div class="card">
          <div class="stat-title">Total Sales</div>
          <div class="stat-value">${{ total_sales }}</div>
        </div>
        <div class="card">
          <div class="stat-title">Orders</div>
          <div class="stat-value">{{ total_quantity }}</div>
        </div>
        <div class="card">
          <div class="stat-title">Customers</div>
          <div class="stat-value">{{ total_customers }}</div>
        </div>
      </section>

      <!-- SALES CHART + ORDERS -->
      <section class="grid-2">
        <div class="card chart-card">
          <div class="chart-title">Sales</div>
          <div class="chart-svg"><div class="card chart-card">
  <div class="chart-title">Sales</div>
  <canvas id="salesChart"></canvas>
</div>
</div>
        </div>
        <div class="card">
          <h3>Recent Orders</h3>
          <div class="recent-list">
            {% for order in recent_cart_items %}
            <div class="order">
              <div class="order-row">
                <div>#{{ cart_items.id }} - {{ cart_items.user.username }}</div>
                <span class="badge {{ cart_items.status }}">{{ cart_items.status|capitalize }}</span>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </section>

      <!-- PRODUCTS -->
      <section class="bottom-grid">
        <div class="products">
          {% for product in recent_products %}
          <div class="product">
            <div class="shoe"></div>
            <div class="pname">{{ product.name }}</div>
            <div class="price">${{ product.price }}</div>
          </div>
          {% endfor %}
        </div>
        <div class="right-column">
          <h3>Recent Orders</h3>
          <div class="order"><div class="order-row"><div>#1234 - John Doe</div><span class="badge delivered">Delivered</span></div></div>
          <div class="order"><div class="order-row"><div>#1232 - Emily Johnson</div><span class="badge pending">Pending</span></div></div>
        </div>
      </section>
    </section>

    <!-- PRODUCTS PAGE -->
    <section id="products" class="main-section" style="display:none">
      <div class="container">
        <div class="header">
          <h2>Products</h2>
          <button class="add-btn">Add Product</button>
        </div>

        <!-- Form thêm sản phẩm -->
        <div id="addProductForm" style="display:none" class="form-container">
          <h3>Thêm sản phẩm mới</h3>
          <form method="POST" action="/add_product">
            <label>Tên sản phẩm:</label>
            <input type="text" name="name" required>

            <label>Giá:</label>
            <input type="number" name="price" required>

            <label>Số lượng tồn kho:</label>
            <input type="number" name="inventory" required>

            <label>Ảnh (URL):</label>
            <input type="text" name="image_url">

            <button type="submit">Lưu</button>
            <button type="button" onclick="closeForm()">Hủy</button>
          </form>
        </div>

        <!-- Bảng sản phẩm -->
        <table>
          <thead><tr><th>Image</th><th>Name</th><th>Price</th><th>Inventory</th></tr></thead>
          <tbody>
            {% for product in products %}
            <tr>
              <td><img src="{{ product.image_url }}" class="product-img"></td>
              <td>{{ product.name }}</td>
              <td>${{ product.price }}</td>
              <td>{{ product.inventory }} in stock</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>

    <!-- ORDERS PAGE -->
    <section id="orders" class="main-section" style="display:none">
      <h2>Orders</h2>
      <div class="recent-list">
        {% for cart in carts %}
        <div class="order">
          <div class="order-row">
            <div>Tên sản phẩm: {{ cart.product.name }}</div>
            <span class="badge {{ cart.status }}">{{ cart.status|capitalize }}</span>
            <div>Số lượng: {{ cart.quantity }}</div>
            <div>Ngày tạo: {{ cart.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
          </div>
        </div>
        {% endfor %}
      </div>
    </section>

  </main>
</div>

<script>
function showSection(id) {
  // Ẩn tất cả section
  document.querySelectorAll('main .main-section').forEach(sec => sec.style.display = 'none');
  // Hiện section được chọn
  document.getElementById(id).style.display = 'block';
  
  // Active menu
  document.querySelectorAll('.nav a').forEach(a => a.classList.remove('active'));
  document.querySelector(`.nav a[onclick="showSection('${id}')"]`).classList.add('active');
}

// Hiện form thêm sản phẩm
document.addEventListener('DOMContentLoaded', () => {
  document.querySelector('.add-btn').addEventListener('click', () => {
    document.getElementById('addProductForm').style.display = 'block';
  });
});

function closeForm() {
  document.getElementById('addProductForm').style.display = 'none';
}
 

</script>
</body>
</html>
